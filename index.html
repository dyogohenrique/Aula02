<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lojinha - Compre aqui</title>

    <!-- Incluindo os estilos do Bootstrap para formatação -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <style>
        body {
            background-color: #292a2a;
            color: #fff;
        }
    </style>
</head>

<body>
    <main class="container">
        <h1 class="text-center">Cadastro de Vendas</h1>

        <!-- Formulário de cadastro -->
        <div class="col-md-6 mx-auto mb-3">
            <form class="row" id="formularioVenda">
                <!-- Campo para o nome do comprador -->
                <div class="col-12 mb-3">
                    <label for="nome" class="form-label">Digite o seu nome completo</label>
                    <input type="text" class="form-control" name="comprador" id="nome" required>
                </div>

                <!-- Campo para a data de nascimento -->
                <div class="col-md-3 mb-3">
                    <label for="dataNascimento" class="form-label">Data de Nascimento</label>
                    <input type="date" class="form-control" name="dataNascimento" id="dataNascimento" required>
                </div>
            
                <!-- Campo para o CPF -->
                <div class="col-md-4 mb-3">
                    <label for="CPF" class="form-label">Digite seu CPF</label>
                    <input type="text" class="form-control" name="CPF" id="CPF" minlength="11" maxlength="11" placeholder="12345678912" required>
                </div>

                <!-- Campo para selecionar o sexo -->
                <div class="col mb-3">
                    <label for="sexo">Sexo</label>
                    <div>
                        <!-- Opção para "Masculino" -->
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sexo" id="masculino" value="masculino" checked>
                            <label class="form-check-label" for="masculino">Masculino</label>
                        </div>
                        <!-- Opção para "Feminino" -->
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sexo" id="feminino" value="feminino">
                            <label class="form-check-label" for="feminino">Feminino</label>
                        </div>
                    </div>
                </div>

                <!-- Campos para endereço -->
                <div class="row">
                    <!-- Campo para CEP -->
                    <div class="col-md-5">
                        <label for="cep" class="form-label">CEP</label>
                        <input type="text" class="form-control" name="cep" id="cep" maxlength="8" minlength="8" required>
                    </div>

                    <div class="row mt-2">
                        <!-- Campo para bairro -->
                        <div class="col-md-5">
                            <label for="bairro" class="form-label">Bairro</label>
                            <input type="text" class="form-control" name="bairro" id="bairro" required>
                        </div>

                        <!-- Campo para rua -->
                        <div class="col-md-5">
                            <label for="rua" class="form-label">Rua</label>
                            <input type="text" class="form-control" name="rua" id="rua" required>
                        </div>

                        <!-- Campo para numero -->
                        <div class="col-md-2">
                            <label for="numero" class="form-label">Nº</label>
                            <input type="text" class="form-control" name="numero" id="numero" required>
                        </div>
                    </div>
                </div>

                <!-- Campo para selecionar a forma de pagamento -->
                <div class="mb-3 mt-3">
                    <label>Insira a sua forma de pagamento</label>
                    <!-- Opção para "PIX" -->
                    <div>
                        <input type="radio" name="pagamento" id="pix" class="form-check-input" onchange="mostrarCamposCartao(false)" value="PIX" checked>
                        <label for="pix" class="form-check-label">PIX</label>
                    </div>

                    <!-- Opção para "Boleto" -->
                    <div>
                        <input type="radio" name="pagamento" id="boleto" class="form-check-input" onchange="mostrarCamposCartao(false)" value="Boleto">
                        <label for="boleto" class="form-check-label">Boleto</label>
                    </div>
                    
                    <!-- Opção para "Cartão de Crédito" -->
                    <div>
                        <input type="radio" name="pagamento" id="credito" class="form-check-input" onchange="mostrarCamposCartao(true)" value="Cartão de Crédito">
                        <label for="credito" class="form-check-label">Cartão de Crédito</label>
                    </div>
                </div>

                <!-- Campos para informações do cartão de crédito (inicialmente ocultos) -->
                <div class="row" id="cartaocredito" style="display: none;">
                    <!-- Campo para o numero do cartão -->
                    <div class="col-md-4 mb-3">
                        <label for="numCartao" class="form-label">Nº do cartão</label>
                        <input type="text" class="form-control" id="numCartao" minlength="16" maxlength="16">
                    </div>

                    <!-- Campo para a data de validade do cartãos -->
                    <div class="col-md-4 mb-3">
                        <label for="validade" class="form-label">Data de validade</label>
                        <input type="month" class="form-control" name="validade" id="validade">
                    </div>

                    <!-- Campo para o codigo de segurança -->
                    <div class="col-md-2 mb-3">
                        <label for="codigoSeguraca" class="form-label">CVC</label>
                        <input type="text" class="form-control" id="codigoSeguraca" minlength="3" maxlength="3">
                    </div>

                </div>

                <!-- Botões para confirmar, apagar e exibir cadastros -->
                <div class="col-12 mt-3">
                    <button type="submit" class="btn btn-success">Confirmar</button>
                    <button type="button" class="btn btn-danger mx-4" onclick="apagar()">Apagar</button>
                    <button type="button" class="btn btn-info" onclick="mostrarCadastros()">Exibir cadastros</button>
                </div>

                <!-- Div para exibir os cadastros (inicialmente oculta) -->
                <div class="mt-3" id="exibirCadastro" style="display: none;">
                    <h2>Cadastros:</h2>
                    <ul id="cadastros">
                        <!-- Os cadastros serão adicionados aqui dinamicamente -->
                    </ul>
                </div>
            </form>
        </div>
    </main>

    <!-- Script JavaScript -->
    <script>
        // Obtém referências para elementos do HTML
        const formularioVenda = document.getElementById("formularioVenda");
        const exibirCadastro = document.getElementById("exibirCadastro");
        const cadastroList = document.getElementById("cadastros")
        
        // Função para adicionar um cadastro à lista exibida
        function adicionarCadastro(cadastro) {
            // Cria um novo elemento de lista (li)
            const itemLista = document.createElement("li");
            
            // Define o conteúdo do elemento de lista com as informações do cadastro
            itemLista.innerHTML = `<h4>Nome: ${cadastro.nome}</h4> 
                                    <p>Data de nascimento: ${cadastro.dataNascimento}</p> 
                                    <p>Idade: ${cadastro.idade}</p> 
                                    <p>CPF: ${cadastro.cpf}</p>
                                    <p>Endereço: Rua ${cadastro.rua}, ${cadastro.numero}. Bairro ${cadastro.bairro} - ${cadastro.cep}</p>
                                    <p>Sexo: ${cadastro.sexo}</p>
                                    <p>Forma de Pagamento: ${cadastro.formaPagamento}</p>`;

            // Se a forma de pagamento for "Cartão de Crédito", exibe informações adicionais
            if (cadastro.formaPagamento === "Cartão de Crédito") {
                itemLista.innerHTML += `<p>Número do Cartão: ${cadastro.numCartao}</p>
                                        <p>Data de Validade: ${cadastro.dataValidade}</p>
                                        <p>Código de Segurança: ${cadastro.codigoSeguraca}</p>`;
            }

            // Adiciona o elemento 'itemLista' (representando um cadastro) à lista de cadastros 'cadastroList'.
            cadastroList.appendChild(itemLista);
        }

        // Evento de envio do formulário
        formularioVenda.addEventListener("submit", (e) => {
            e.preventDefault(); // Evita a submissão do formulário padrão
            salvar(); // Chama a função para salvar o cadastro
            apagar(); // Chama a função para limpar o formulário
        });

        // Função para salvar o cadastro
        function salvar() {
            // Obtém os valores dos campos do formulário
            const nome = document.getElementById("nome").value;
            const dataNascimento = document.getElementById("dataNascimento").value;
            const cpf = document.getElementById("CPF").value;
            const sexo = document.querySelector('input[name="sexo"]:checked').value;
            const cep = document.getElementById("cep").value;
            const bairro = document.getElementById("bairro").value;
            const rua = document.getElementById("rua").value;
            const numero = document.getElementById("numero").value;
            const formaPagamento = document.querySelector('input[name="pagamento"]:checked').value;

            // Inicializa variáveis para informações de cartão de crédito
            let numCartao = "";
            let dataValidade = "";
            let codigoSeguraca = "";

            // Se a forma de pagamento for "Cartão de Crédito", obtém as informações adicionais
            if (formaPagamento === "Cartão de Crédito") {
                numCartao = document.getElementById("numCartao").value;
                dataValidade = document.getElementById("validade").value;
                codigoSeguraca = document.getElementById("codigoSeguraca").value;
            }

            // Calcula a idade com base na data de nascimento
            const hoje = new Date();
            const nascimento = new Date(dataNascimento);
            const idade = hoje.getFullYear() - nascimento.getFullYear();

            // Cria um objeto de cadastro com os dados coletados
            const cadastro = {
                nome,
                dataNascimento,
                idade,
                cpf,
                sexo,
                cep,
                bairro,
                rua,
                numero,
                formaPagamento,
                numCartao,
                dataValidade,
                codigoSeguraca
            };

            // Chama a função para exibir o cadastro na lista
            adicionarCadastro(cadastro);
        }

        // Função para limpar o formulário
        function apagar() {
            formularioVenda.reset(); // Limpa os campos do formulário
            mostrarCamposCartao(false); // Oculta os campos de cartão de crédito
        }
        
        // Função para mostrar/ocultar campos de cartão de crédito com base na forma de pagamento selecionada
        function mostrarCamposCartao(exibir) {
            if (exibir) {
                cartaocredito.style.display = "flex"; // Mostra os campos de cartão de crédito
            } else {
                cartaocredito.style.display = "none"; // Oculta os campos de cartão de crédito
            }
        }

        // Função para mostrar/ocultar a lista de cadastros
        function mostrarCadastros() {
            if (exibirCadastro.style.display === "none" || exibirCadastro.style.display === "") {
                exibirCadastro.style.display = "block"; // Mostra a lista de cadastros
            } else {
                exibirCadastro.style.display = "none"; // Oculta a lista de cadastros
            }
        }
    </script>

</body>
</html>